// 18-06-2020
if(document.querySelector("#basket")){const e=document.querySelector("#basket-quantity"),t=document.querySelector("#basket-sum"),a=document.querySelector("#basket-goods");function addGoods(){const e={name:this.dataset.name,size:this.dataset.size,price:this.dataset.price,number:"1",img:this.dataset.img};if(null===localStorage.getItem("basket")){const t=[];t.push(e),localStorage.setItem("basket",JSON.stringify(t)),viewQuantity(),viewSum(),viewSelected()}else{const t=JSON.parse(localStorage.getItem("basket")),a=this.dataset.name;if(t.find(e=>e.name==a)){t.find(e=>e.name===a).number++}else t.push(e);localStorage.setItem("basket",JSON.stringify(t)),viewQuantity(),viewSum(),viewSelected()}}function viewQuantity(){null===localStorage.getItem("basket")?e.innerHTML=0:e.innerHTML=JSON.parse(localStorage.getItem("basket")).reduce((e,t)=>e+=+t.number,0)}function viewSum(){null===localStorage.getItem("basket")?t.innerHTML=0:t.innerHTML=JSON.parse(localStorage.getItem("basket")).map(e=>e.price*e.number).reduce((e,t)=>e+ +t,0)+"грн"}function clearStorage(){localStorage.clear("basket"),viewSum(),viewQuantity(),viewSelected()}function viewSelected(){null===localStorage.getItem("basket")?a.innerHTML="":a.innerHTML=JSON.parse(localStorage.getItem("basket")).reduce((e,t,a)=>e+`<p data-id="${a}"><i></i> ${t.name} [${t.number}]: ${t.size} - ${t.price}грн</p>`,"")}function removeGoods(e){if("I"===e.target.tagName){const t=e.target.parentNode.dataset.id,a=JSON.parse(localStorage.getItem("basket"));a.splice(t,1),0===a.length?localStorage.removeItem("basket"):localStorage.setItem("basket",JSON.stringify(a)),viewSum(),viewQuantity(),viewSelected()}}document.querySelectorAll("button").forEach(e=>e.addEventListener("click",addGoods)),document.querySelector("#basket-clear").addEventListener("click",clearStorage),a.addEventListener("click",e=>removeGoods(e)),viewSum(),viewQuantity(),viewSelected()}if(document.querySelector("#order-goods")){const e=document.querySelector("#order-goods"),t=document.querySelector("#order-sum");function viewGoods(){null===localStorage.getItem("basket")?e.innerHTML="":e.innerHTML=JSON.parse(localStorage.getItem("basket")).reduce((e,t,a)=>e+`\n\t\t\t\t\t\t\t<p data-id="${a}"><img src="${t.img}" alt=""><i></i><b>${t.name}</b><span>${t.size} </span><span><b>${t.price}</b>грн </span><span class="minus"></span><span class="number">${t.number}</span><span class="plus"></span></p>`,"")}function changeGoods(e){const t=e.target.parentNode.dataset.id,a=JSON.parse(localStorage.getItem("basket"));"I"===e.target.tagName?(a.splice(t,1),0===a.length?localStorage.removeItem("basket"):localStorage.setItem("basket",JSON.stringify(a))):"minus"===e.target.className?a[t].number>1?a[t].number--:a.splice(t,1):"plus"===e.target.className&&a[t].number++,localStorage.setItem("basket",JSON.stringify(a)),localStorage.getItem("basket").length<3&&localStorage.clear("basket"),viewGoods(),viewSum()}function viewSum(){null===localStorage.getItem("basket")?t.style.display="none":(t.innerHTML=JSON.parse(localStorage.getItem("basket")).map(e=>e.price*e.number).reduce((e,t)=>e+ +t,0)+"грн",t.style.display="block")}e.addEventListener("click",e=>changeGoods(e)),viewGoods(),viewSum()}